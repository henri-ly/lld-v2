// @flow

import React, { useCallback, useState } from "react";
import { getAccountBridge } from "@ledgerhq/live-common/lib/bridge";
import { StellarMemoType } from "@ledgerhq/live-common/lib/families/stellar/types";
import Input from "~/renderer/components/Input";
import invariant from "invariant";

const MemoValueField = ({ onChange, account, transaction, status }: Props) => {
  invariant(transaction.family === "stellar", "MemoTypeField: stellar family expected");

  const bridge = getAccountBridge(account);

  const onMemoValueChange = useCallback(
    memoValue => {
      onChange(bridge.updateTransaction(transaction, { memoValue }));
    },
    [onChange, transaction, bridge, account],
  );

  // We use transaction as an error here.
  // It will be usefull to block a memo wrong format
  // on the ledger-live mobile
  const { transaction: memoError } = status.errors;
  const { transaction: memoWarning } = status.warnings;

  return (
    <Input
      warning={memoWarning}
      error={memoError}
      value={transaction.memoValue}
      onChange={onMemoValueChange}
    />
  );
};

export default MemoValueField;
